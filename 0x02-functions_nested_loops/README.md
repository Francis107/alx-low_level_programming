This is functions on nested loops
